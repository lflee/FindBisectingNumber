<!DOCTYPE html><html><head>
  <title>active-state</title>

  <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
  <script src="../../web-component-tester/browser.js"></script>
  <script src="../../test-fixture/test-fixture-mocha.js"></script>
  <script src="../../iron-test-helpers/mock-interactions.js"></script>

  <link rel="import" href="../../polymer/polymer.html">
  <link rel="import" href="../../test-fixture/test-fixture.html">
  <link rel="import" href="test-elements.html">
</head>
<body>
  <test-fixture id="TrivialActiveState">
    <template>
      <test-button></test-button>
    </template>
  </test-fixture>

  <test-fixture id="ToggleActiveState">
    <template>
      <test-button toggles=""></test-button>
    </template>
  </test-fixture>

  <script>suite("active-state",function(){var t;setup(function(){t=fixture("TrivialActiveState")}),suite("non-primary pointer input source",function(){test("does not cause state to change",function(){var e=new CustomEvent("mousedown");e.buttons=2,t.dispatchEvent(e),expect(t.pressed).to.be.equal(!1)})}),suite("active state with toggles attribute",function(){setup(function(){t=fixture("ToggleActiveState")}),suite("when clicked",function(){test("is activated",function(e){MockInteractions.downAndUp(t,function(){try{expect(t.hasAttribute("active")).to.be.eql(!0),expect(t.hasAttribute("aria-pressed")).to.be.eql(!0),expect(t.getAttribute("aria-pressed")).to.be.eql("true"),e()}catch(t){e(t)}})}),test("is deactivated by a subsequent click",function(e){MockInteractions.downAndUp(t,function(){MockInteractions.downAndUp(t,function(){try{expect(t.hasAttribute("active")).to.be.eql(!1),expect(t.hasAttribute("aria-pressed")).to.be.eql(!0),expect(t.getAttribute("aria-pressed")).to.be.eql("false"),e()}catch(t){e(t)}})})}),test("the correct aria attribute is set",function(e){t.ariaActiveAttribute="aria-checked",MockInteractions.downAndUp(t,function(){try{expect(t.hasAttribute("active")).to.be.eql(!0),expect(t.hasAttribute("aria-checked")).to.be.eql(!0),expect(t.getAttribute("aria-checked")).to.be.eql("true"),e()}catch(t){e(t)}})}),test("the aria attribute is updated correctly",function(e){t.ariaActiveAttribute="aria-checked",MockInteractions.downAndUp(t,function(){try{expect(t.hasAttribute("active")).to.be.eql(!0),expect(t.hasAttribute("aria-checked")).to.be.eql(!0),expect(t.getAttribute("aria-checked")).to.be.eql("true"),t.ariaActiveAttribute="aria-pressed",expect(t.hasAttribute("aria-checked")).to.be.eql(!1),expect(t.hasAttribute("aria-pressed")).to.be.eql(!0),expect(t.getAttribute("aria-pressed")).to.be.eql("true"),e()}catch(t){e(t)}})})})}),suite("without toggles attribute",function(){suite("when mouse is down",function(){test("does not get an active attribute",function(){expect(t.hasAttribute("active")).to.be.eql(!1),MockInteractions.down(t),expect(t.hasAttribute("active")).to.be.eql(!1)})}),suite("when mouse is up",function(){test("does not get an active attribute",function(){MockInteractions.down(t),expect(t.hasAttribute("active")).to.be.eql(!1),MockInteractions.up(t),expect(t.hasAttribute("active")).to.be.eql(!1)})})}),suite("when space is pressed",function(){test("triggers a click event",function(e){t.addEventListener("click",function(){e()}),MockInteractions.pressSpace(t)}),test("only triggers click after the key is released",function(e){var i=!1;t.addEventListener("keyup",function(){i=!0}),t.addEventListener("click",function(){try{expect(i).to.be.eql(!0),e()}catch(t){e(t)}}),MockInteractions.pressSpace(t)})}),suite("when enter is pressed",function(){test("triggers a click event",function(e){t.addEventListener("click",function(){e()}),MockInteractions.pressEnter(t)}),test("only triggers click before the key is released",function(e){var i=!1;t.addEventListener("keyup",function(){i=!0}),t.addEventListener("click",function(){try{expect(i).to.be.eql(!1),e()}catch(t){e(t)}}),MockInteractions.pressEnter(t)})})});</script>


</body></html>